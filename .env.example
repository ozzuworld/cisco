# CUCM Log Collector - Environment Variables (Example)
# Copy this file to .env and fill in your values
#
# For Docker deployment, see docker-compose.yml for recommended settings

# =============================================================================
# API Settings
# =============================================================================
API_HOST=0.0.0.0
API_PORT=8000
LOG_LEVEL=INFO

# Authentication (v0.3) - Optional
# If API_KEY is set, enables bearer token authentication
# If not set or empty, authentication is disabled (dev mode)
API_KEY=

# CORS - Allowed origins regex pattern
# Default allows localhost for development
# For production, set to your frontend domain(s)
CORS_ALLOWED_ORIGINS=^https?://(localhost|127\.0\.0\.1)(:\d+)?$

# =============================================================================
# SFTP Client Settings (what we tell CUCM to connect to)
# =============================================================================
# SFTP_HOST: The IP/hostname that CUCM devices use to connect back
#
# AUTO-DETECTION (recommended): Leave empty - the app auto-detects its IP!
# The app uses socket connection to find the correct external IP address.
#
# Manual override: Set to a specific IP if auto-detection doesn't work
# (e.g., multiple network interfaces, NAT, or specific routing needs)
SFTP_HOST=

SFTP_PORT=2222
SFTP_USERNAME=cucm-collector
SFTP_PASSWORD=your-secure-password

# SFTP_REMOTE_BASE_DIR - Directory path on SFTP server
# For embedded SFTP server (Docker mode): Leave EMPTY
# Backend creates: {job-id}/{node}/ directories
# Files land at: storage/received/{job-id}/{node}/
SFTP_REMOTE_BASE_DIR=

# =============================================================================
# Embedded SFTP Server Settings (Docker mode)
# =============================================================================
# When enabled, runs an asyncssh SFTP server inside the container
# This eliminates the need for a separate system SFTP server

# Enable/disable embedded SFTP server
# Set to true for Docker, false for bare metal with external SFTP
SFTP_SERVER_ENABLED=false

# SFTP server bind address (0.0.0.0 to listen on all interfaces)
SFTP_SERVER_HOST=0.0.0.0

# SFTP server port (default 2222 to avoid conflict with system SSH)
SFTP_SERVER_PORT=2222

# SSH host key path (auto-generated if not set)
# SFTP_SERVER_HOST_KEY_PATH=/app/storage/ssh_host_key

# =============================================================================
# Storage Settings
# =============================================================================
# Local directory where transcripts, jobs, and received artifacts are stored
STORAGE_ROOT=./storage

# =============================================================================
# Job Execution Settings
# =============================================================================
MAX_CONCURRENCY_PER_JOB=2
JOB_COMMAND_TIMEOUT_SEC=600
JOB_CONNECT_TIMEOUT_SEC=30

# =============================================================================
# Security Settings
# =============================================================================
MAX_SSH_RETRIES=3
MAX_SFTP_RETRIES=3

# =============================================================================
# Retention & Cleanup
# =============================================================================
RETENTION_DAYS=7
CLEANUP_ENABLED=true

# =============================================================================
# Profiles
# =============================================================================
PROFILES_PATH=./profiles.yaml
